<!doctype html><html lang=ko dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>AWS SAM을 이용해서 Lambda함수 배포하기 | Bokyung's Note</title><meta name=keywords content="AWS,AWS SAM,AWS Lambda,AWS S3"><meta name=description content="이전 글에서 CloudFront와 Lambda@Edge를 이용해서 이미지 리사이징하기 를 정리해 보았는데요. AWS SAM을 이용해서 CloudFormation으로 Lambda함수를 배포하는 방법을 정리해 보았습니다.
배포순서 SAM CLI설치 Install SAM CLI 
저는 SAM CLI, version 1.23.0을 이용했습니다
template.yaml작성 CloudFormation기반의 템플릿(template.yaml)을 작성합니다.
. ├── index.js ├── node_modules/ ├── template.yaml ├── package-lock.json └── package.json  SAM deploy을 이용하여 코드 패키징과 배포 SAM deploy \  --template-file template.yaml \  # Lambda@edge인 경우는 us-east-1리전에 만든 Bucket이 필요합니다. --s3-bucket <zip파일을 업로드 할 Bucket name> \  --s3-prefix SAM \  --stack-name <cloudformation 스택명> \  --capabilities CAPABILITY_NAMED_IAM \  --region <cloudformation을 배포 할 리전> \  --profile <profile name> SAM은 배포 시"><meta name=author content="bokyung"><link rel=canonical href=https://bokyung.dev/2021/05/17/lambda-sam-deploy/><link href=/assets/css/stylesheet.min.16bd97329ca7f2188829d7cfd3e3c39c68f9f28afc3b6f43b1ac7302a00e6faf.css integrity="sha256-Fr2XMpyn8hiIKdfP0+PDnGj58or8O29DsaxzAqAOb68=" rel="preload stylesheet" as=style><link rel=icon href=https://bokyung.dev/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://bokyung.dev/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://bokyung.dev/favicon-32x32.png><link rel=apple-touch-icon href=https://bokyung.dev/apple-touch-icon.png><link rel=mask-icon href=https://bokyung.dev/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><meta name=generator content="Hugo 0.83.1"><link rel=alternate hreflang=ko href=https://bokyung.dev/2021/05/17/lambda-sam-deploy/><link rel=alternate hreflang=ja href=https://bokyung.dev/ja/2021/05/17/lambda-sam-deploy/><meta property="og:title" content="AWS SAM을 이용해서 Lambda함수 배포하기"><meta property="og:description" content="이전 글에서 CloudFront와 Lambda@Edge를 이용해서 이미지 리사이징하기 를 정리해 보았는데요. AWS SAM을 이용해서 CloudFormation으로 Lambda함수를 배포하는 방법을 정리해 보았습니다.
배포순서 SAM CLI설치 Install SAM CLI 
저는 SAM CLI, version 1.23.0을 이용했습니다
template.yaml작성 CloudFormation기반의 템플릿(template.yaml)을 작성합니다.
. ├── index.js ├── node_modules/ ├── template.yaml ├── package-lock.json └── package.json  SAM deploy을 이용하여 코드 패키징과 배포 SAM deploy \  --template-file template.yaml \  # Lambda@edge인 경우는 us-east-1리전에 만든 Bucket이 필요합니다. --s3-bucket <zip파일을 업로드 할 Bucket name> \  --s3-prefix SAM \  --stack-name <cloudformation 스택명> \  --capabilities CAPABILITY_NAMED_IAM \  --region <cloudformation을 배포 할 리전> \  --profile <profile name> SAM은 배포 시"><meta property="og:type" content="article"><meta property="og:url" content="https://bokyung.dev/2021/05/17/lambda-sam-deploy/"><meta property="article:published_time" content="2021-05-17T00:00:00+00:00"><meta property="article:modified_time" content="2021-05-17T00:00:00+00:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="AWS SAM을 이용해서 Lambda함수 배포하기"><meta name=twitter:description content="이전 글에서 CloudFront와 Lambda@Edge를 이용해서 이미지 리사이징하기 를 정리해 보았는데요. AWS SAM을 이용해서 CloudFormation으로 Lambda함수를 배포하는 방법을 정리해 보았습니다.
배포순서 SAM CLI설치 Install SAM CLI 
저는 SAM CLI, version 1.23.0을 이용했습니다
template.yaml작성 CloudFormation기반의 템플릿(template.yaml)을 작성합니다.
. ├── index.js ├── node_modules/ ├── template.yaml ├── package-lock.json └── package.json  SAM deploy을 이용하여 코드 패키징과 배포 SAM deploy \  --template-file template.yaml \  # Lambda@edge인 경우는 us-east-1리전에 만든 Bucket이 필요합니다. --s3-bucket <zip파일을 업로드 할 Bucket name> \  --s3-prefix SAM \  --stack-name <cloudformation 스택명> \  --capabilities CAPABILITY_NAMED_IAM \  --region <cloudformation을 배포 할 리전> \  --profile <profile name> SAM은 배포 시"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"AWS SAM을 이용해서 Lambda함수 배포하기","name":"AWS SAM을 이용해서 Lambda함수 배포하기","description":"이전 글에서 CloudFront와 Lambda@Edge를 이용해서 이미지 리사이징하기 를 정리해 보았는데요. AWS SAM을 이용해서 CloudFormation으로 Lambda함수를 배포하는 방법을 정리해 보았습니다.\n배포순서 SAM CLI설치 Install SAM CLI \n저는 SAM CLI, version 1.23.0 …","keywords":["AWS","AWS SAM","AWS Lambda","AWS S3"],"articleBody":"이전 글에서 CloudFront와 Lambda@Edge를 이용해서 이미지 리사이징하기 를 정리해 보았는데요. AWS SAM을 이용해서 CloudFormation으로 Lambda함수를 배포하는 방법을 정리해 보았습니다.\n배포순서 SAM CLI설치 Install SAM CLI \n저는 SAM CLI, version 1.23.0을 이용했습니다\ntemplate.yaml작성 CloudFormation기반의 템플릿(template.yaml)을 작성합니다.\n. ├── index.js ├── node_modules/ ├── template.yaml ├── package-lock.json └── package.json  SAM deploy을 이용하여 코드 패키징과 배포 SAM deploy \\  --template-file template.yaml \\  # Lambda@edge인 경우는 us-east-1리전에 만든 Bucket이 필요합니다. --s3-bucket \\  --s3-prefix SAM \\  --stack-name \\  --capabilities CAPABILITY_NAMED_IAM \\  --region \\  --profile SAM은 배포 시\n 애플리케이션의 코드를 압축해서 S3에 업로드 CodeUri가 S3 path로 변경된 CloudFormation 템플릿파일 생성, S3에 업로드 S3에 업로드된 파일을 이용해서 Cloudformation 스택을 생성하여 배포  Cloudformation 콘솔에서 Template를 확인하시거나 S3에 업로드된 Template를 다운받아서 열어 보시면 Code Uri에 S3를 지정하고 있는 것을 확인 할 수 있습니다.\nCodeUri: s3:///SAM/70b53b458e040c19f27aaf1d7f197e0e Cloudformation 스택생성이 완료되면 Outputs에 람다함수의 새로 배포된 Version정보를 포함한 ARN정보를 표시해줍니다.\n이 ARN을 Cloudfront의 리사이징용 Behaviors  Edge Function Associations  Function ARN/Name에 넣어주었습니다.\n참고  https://github.com/awslabs/serverless-application-model/blob/master/versions/2016-10-31.md#awsserverlessfunction   ","wordCount":"168","inLanguage":"ko","datePublished":"2021-05-17T00:00:00Z","dateModified":"2021-05-17T00:00:00Z","author":{"@type":"Person","name":"bokyung"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://bokyung.dev/2021/05/17/lambda-sam-deploy/"},"publisher":{"@type":"Organization","name":"Bokyung's Note","logo":{"@type":"ImageObject","url":"https://bokyung.dev/favicon.ico"}}}</script><script async src="https://www.googletagmanager.com/gtag/js?id=G-R7DJYPBNN5"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag('js',new Date),gtag('config','G-R7DJYPBNN5')</script><script>(function(b,d,e,a,g){b[a]=b[a]||[],b[a].push({'gtm.start':(new Date).getTime(),event:'gtm.js'});var f=d.getElementsByTagName(e)[0],c=d.createElement(e),h=a!='dataLayer'?'&l='+a:'';c.async=!0,c.src='https://www.googletagmanager.com/gtm.js?id='+g+h,f.parentNode.insertBefore(c,f)})(window,document,'script','dataLayer','GTM-KTQ8KCW')</script></script></head><body id=top><noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-KTQ8KCW" height=0 width=0 style=display:none;visibility:hidden></iframe></noscript><script>window.matchMedia('(prefers-color-scheme: dark)').matches&&document.body.classList.add('dark')</script><noscript><style type=text/css>.theme-toggle,.top-link{display:none}</style></noscript><header class=header><nav class=nav><div class=logo><a href=https://bokyung.dev/ accesskey=h title="Bokyung's Note (Alt + H)"><img src=/images/main_icon.jpg alt=logo aria-label=logo width=30px>Bokyung's Note</a>
<span class=logo-switches><ul class=lang-switch><li>|</li><li><a href=https://bokyung.dev/ja/ title=ja aria-label=ja>Ja</a></li></ul></span></div><ul id=menu onscroll=menu_on_scroll()><li><a href=https://bokyung.dev/archives/ title=Archive><span>Archive</span></a></li><li><a href=https://bokyung.dev/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li><li><a href=https://bokyung.dev/tags/ title=Tags><span>Tags</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=ad-box><script async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script><ins class=adsbygoogle style=display:block data-ad-client=ca-pub-8342838924011258 data-ad-slot=6402405361 data-ad-format=auto data-full-width-responsive=true></ins><script>(adsbygoogle=window.adsbygoogle||[]).push({})</script></div><h1 class=post-title>AWS SAM을 이용해서 Lambda함수 배포하기</h1><div class=post-meta>2021-05-17&nbsp;·&nbsp;bokyung
&nbsp;|&nbsp;<ul class=i18n_list>Translations:<li><a href=https://bokyung.dev/ja/2021/05/17/lambda-sam-deploy/>Ja</a></li></ul></div></header><div class=toc><details open><summary accesskey=c title="(Alt + C)"><div class=details>목차</div></summary><div class=inner><ul><li><a href=#%eb%b0%b0%ed%8f%ac%ec%88%9c%ec%84%9c aria-label=배포순서>배포순서</a><ul><li><a href=#sam-cli%ec%84%a4%ec%b9%98 aria-label="SAM CLI설치">SAM CLI설치</a></li><li><a href=#templateyaml%ec%9e%91%ec%84%b1 aria-label=template.yaml작성>template.yaml작성</a></li><li><a href=#sam-deploy%ec%9d%84-%ec%9d%b4%ec%9a%a9%ed%95%98%ec%97%ac-%ec%bd%94%eb%93%9c-%ed%8c%a8%ed%82%a4%ec%a7%95%ea%b3%bc-%eb%b0%b0%ed%8f%ac aria-label="SAM deploy을 이용하여 코드 패키징과 배포">SAM deploy을 이용하여 코드 패키징과 배포</a></li></ul></li><li><a href=#%ec%b0%b8%ea%b3%a0 aria-label=참고>참고</a></li></ul></div></details></div><div class=post-content><p>이전 글에서 <a href=https://bokyung.dev/2021/05/14/lambda-edge-resize/>CloudFront와 Lambda@Edge를 이용해서 이미지 리사이징하기
</a>를 정리해 보았는데요.
AWS SAM을 이용해서 CloudFormation으로 Lambda함수를 배포하는 방법을 정리해 보았습니다.</p><h2 id=배포순서>배포순서<a hidden class=anchor aria-hidden=true href=#배포순서>#</a></h2><h3 id=sam-cli설치>SAM CLI설치<a hidden class=anchor aria-hidden=true href=#sam-cli설치>#</a></h3><p><a href=https://aws.amazon.com/ko/serverless/SAM/ target=_blank rel=noopener>Install SAM CLI</a></p><p>저는 <code>SAM CLI, version 1.23.0</code>을 이용했습니다</p><h3 id=templateyaml작성>template.yaml작성<a hidden class=anchor aria-hidden=true href=#templateyaml작성>#</a></h3><p>CloudFormation기반의 템플릿(template.yaml)을 작성합니다.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>.
├── index.js
├── node_modules/
├── template.yaml
├── package-lock.json
└── package.json
</code></pre></div><script type=application/javascript src=https://gist.github.com/bokyung-kang/aa6452d3d4f559c4d77ac11fa5bdc876.js></script><h3 id=sam-deploy을-이용하여-코드-패키징과-배포>SAM deploy을 이용하여 코드 패키징과 배포<a hidden class=anchor aria-hidden=true href=#sam-deploy을-이용하여-코드-패키징과-배포>#</a></h3><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>SAM deploy <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>    --template-file template.yaml <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>    <span style=color:#75715e># Lambda@edge인 경우는 us-east-1리전에 만든 Bucket이 필요합니다.</span>
    --s3-bucket &lt;zip파일을 업로드 할  Bucket name&gt; <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>    --s3-prefix SAM <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>    --stack-name &lt;cloudformation 스택명&gt; <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>    --capabilities CAPABILITY_NAMED_IAM <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>    --region &lt;cloudformation을 배포 할 리전&gt; <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>    --profile &lt;profile name&gt;
</code></pre></div><p>SAM은 배포 시</p><ul><li>애플리케이션의 코드를 압축해서 S3에 업로드</li><li>CodeUri가 S3 path로 변경된 CloudFormation 템플릿파일 생성, S3에 업로드</li><li>S3에 업로드된 파일을 이용해서 Cloudformation 스택을 생성하여 배포</li></ul><p>Cloudformation 콘솔에서 Template를 확인하시거나 S3에 업로드된 Template를 다운받아서 열어 보시면 Code Uri에 S3를 지정하고 있는 것을 확인 할 수 있습니다.</p><pre><code>CodeUri: s3://&lt;zip파일을 업로드 할 Bucket name&gt;/SAM/70b53b458e040c19f27aaf1d7f197e0e
</code></pre><p>Cloudformation 스택생성이 완료되면 Outputs에 람다함수의 새로 배포된 Version정보를 포함한 ARN정보를 표시해줍니다.</p><p>이 ARN을 Cloudfront의 리사이징용 Behaviors > Edge Function Associations > Function ARN/Name에 넣어주었습니다.</p><h2 id=참고>참고<a hidden class=anchor aria-hidden=true href=#참고>#</a></h2><ul><li><a href=https://github.com/awslabs/serverless-application-model/blob/master/versions/2016-10-31.md#awsserverlessfunction target=_blank rel=noopener>https://github.com/awslabs/serverless-application-model/blob/master/versions/2016-10-31.md#awsserverlessfunction</a></li></ul></div><footer class=post-footer><ul class=post-tags><li><a href=https://bokyung.dev/tags/aws/>AWS</a></li><li><a href=https://bokyung.dev/tags/aws-sam/>AWS SAM</a></li><li><a href=https://bokyung.dev/tags/aws-lambda/>AWS Lambda</a></li><li><a href=https://bokyung.dev/tags/aws-s3/>AWS S3</a></li></ul><nav class=paginav><a class=next href=https://bokyung.dev/2021/05/14/lambda-edge-resize/><span class=title>다음 페이지 »</span><br><span>CloudFront와 Lambda@Edge를 이용해서 이미지 리사이징하기</span></a></nav><div class=ad-box><script async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script><ins class=adsbygoogle style=display:block data-ad-client=ca-pub-8342838924011258 data-ad-slot=2315271952 data-ad-format=auto data-full-width-responsive=true></ins><script>(adsbygoogle=window.adsbygoogle||[]).push({})</script></div></footer><script src=https://utteranc.es/client.js repo=bokyung-kang/blog-comments issue-term=title theme=github-light crossorigin=anonymous async></script></article></main><footer class=footer><span>&copy; 2021 <a href=https://bokyung.dev/>Bokyung's Note</a></span>
<span>&#183;</span>
<span>Powered by <a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a></span>
<span>&#183;</span>
<span>Theme <a href=https://git.io/hugopapermod rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)"><button class=top-link id=top-link type=button accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></button></a>
<script defer src=/assets/js/highlight.min.7680afc38aa6b15ddf158a4f3780b7b1f7dde7e91d26f073e6229bb7a0793c92.js integrity="sha256-doCvw4qmsV3fFYpPN4C3sffd5+kdJvBz5iKbt6B5PJI=" onload=hljs.initHighlightingOnLoad()></script><script>window.onload=function(){localStorage.getItem("menu-scroll-position")&&(document.getElementById('menu').scrollLeft=localStorage.getItem("menu-scroll-position"))},document.querySelectorAll('a[href^="#"]').forEach(a=>{a.addEventListener("click",function(b){b.preventDefault();var a=this.getAttribute("href").substr(1);window.matchMedia('(prefers-reduced-motion: reduce)').matches?document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView({behavior:"smooth"}),a==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${a}`)})});var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")};function menu_on_scroll(){localStorage.setItem("menu-scroll-position",document.getElementById('menu').scrollLeft)}</script></body></html>