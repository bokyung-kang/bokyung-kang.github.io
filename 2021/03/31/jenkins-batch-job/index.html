<!doctype html><html lang=ko dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Jenkins에서 Spring Batch Job을 실행하기 | Bokyung's Note</title><meta name=keywords content="AWS,Jenkins,Spring"><meta name=description content="Jenkins에서 스프링 배치 Job을 실행해 보았습니다.
Jenkins 환경  Amazon Linux2  AMI ID : ami-0f27d081df46f326c AMI 이름 : amzn2-ami-hvm-2.0.20210303.0-x86_64-gp2   Jenkins  version : Jenkins 2.284    환경변수와 플러그인 설정   여러 Job을 등록하는 경우 각각의 Job에서 같은 파라미터를 넘겨주게 되는데 환경변수에 등록해두면 관리하기가 편해집니다.
  Job파라미터로 실행날짜를 넘겨주기 위해서 timestamper플러그인을 사용하였습니다.     Manage Jenkins > System Configuration > Configure System > Global properties > Environment variables에서 Job에서 공통으로 사용하는 환경변수를 설정합니다."><meta name=author content="bokyung"><link rel=canonical href=https://bokyung.dev/2021/03/31/jenkins-batch-job/><link href=/assets/css/stylesheet.min.4e805d558ffd9ded0176c1359964ce6fbfcee71352a6e8adce933a83de65928d.css integrity="sha256-ToBdVY/9ne0BdsE1mWTOb7/O5xNSpuitzpM6g95lko0=" rel="preload stylesheet" as=style><link rel=icon href=https://bokyung.dev/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://bokyung.dev/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://bokyung.dev/favicon-32x32.png><link rel=apple-touch-icon href=https://bokyung.dev/apple-touch-icon.png><link rel=mask-icon href=https://bokyung.dev/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><meta name=generator content="Hugo 0.82.0"><link rel=alternate hreflang=ko href=https://bokyung.dev/2021/03/31/jenkins-batch-job/><link rel=alternate hreflang=ja href=https://bokyung.dev/ja/2021/03/31/jenkins-batch-job/><script async src="https://www.googletagmanager.com/gtag/js?id=G-R7DJYPBNN5"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag('js',new Date),gtag('config','G-R7DJYPBNN5')</script><script>(function(b,d,e,a,g){b[a]=b[a]||[],b[a].push({'gtm.start':(new Date).getTime(),event:'gtm.js'});var f=d.getElementsByTagName(e)[0],c=d.createElement(e),h=a!='dataLayer'?'&l='+a:'';c.async=!0,c.src='https://www.googletagmanager.com/gtm.js?id='+g+h,f.parentNode.insertBefore(c,f)})(window,document,'script','dataLayer','GTM-KTQ8KCW')</script></script><meta property="og:title" content="Jenkins에서 Spring Batch Job을 실행하기"><meta property="og:description" content="Jenkins에서 스프링 배치 Job을 실행해 보았습니다.
Jenkins 환경  Amazon Linux2  AMI ID : ami-0f27d081df46f326c AMI 이름 : amzn2-ami-hvm-2.0.20210303.0-x86_64-gp2   Jenkins  version : Jenkins 2.284    환경변수와 플러그인 설정   여러 Job을 등록하는 경우 각각의 Job에서 같은 파라미터를 넘겨주게 되는데 환경변수에 등록해두면 관리하기가 편해집니다.
  Job파라미터로 실행날짜를 넘겨주기 위해서 timestamper플러그인을 사용하였습니다.     Manage Jenkins > System Configuration > Configure System > Global properties > Environment variables에서 Job에서 공통으로 사용하는 환경변수를 설정합니다."><meta property="og:type" content="article"><meta property="og:url" content="https://bokyung.dev/2021/03/31/jenkins-batch-job/"><meta property="article:published_time" content="2021-03-31T00:00:00+00:00"><meta property="article:modified_time" content="2021-03-31T00:00:00+00:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="Jenkins에서 Spring Batch Job을 실행하기"><meta name=twitter:description content="Jenkins에서 스프링 배치 Job을 실행해 보았습니다.
Jenkins 환경  Amazon Linux2  AMI ID : ami-0f27d081df46f326c AMI 이름 : amzn2-ami-hvm-2.0.20210303.0-x86_64-gp2   Jenkins  version : Jenkins 2.284    환경변수와 플러그인 설정   여러 Job을 등록하는 경우 각각의 Job에서 같은 파라미터를 넘겨주게 되는데 환경변수에 등록해두면 관리하기가 편해집니다.
  Job파라미터로 실행날짜를 넘겨주기 위해서 timestamper플러그인을 사용하였습니다.     Manage Jenkins > System Configuration > Configure System > Global properties > Environment variables에서 Job에서 공통으로 사용하는 환경변수를 설정합니다."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Jenkins에서 Spring Batch Job을 실행하기","name":"Jenkins에서 Spring Batch Job을 실행하기","description":"Jenkins에서 스프링 배치 Job을 실행해 보았습니다.\nJenkins 환경  Amazon Linux2  AMI ID : ami-0f27d081df46f326c AMI 이름 : amzn2-ami-hvm-2.0.20210303.0-x86_64-gp2   Jenkins  version : Jenkins 2.284    환경 …","keywords":["AWS","Jenkins","Spring"],"articleBody":"Jenkins에서 스프링 배치 Job을 실행해 보았습니다.\nJenkins 환경  Amazon Linux2  AMI ID : ami-0f27d081df46f326c AMI 이름 : amzn2-ami-hvm-2.0.20210303.0-x86_64-gp2   Jenkins  version : Jenkins 2.284    환경변수와 플러그인 설정   여러 Job을 등록하는 경우 각각의 Job에서 같은 파라미터를 넘겨주게 되는데 환경변수에 등록해두면 관리하기가 편해집니다.\n  Job파라미터로 실행날짜를 넘겨주기 위해서 timestamper플러그인을 사용하였습니다.     Manage Jenkins  System Configuration  Configure System  Global properties  Environment variables에서 Job에서 공통으로 사용하는 환경변수를 설정합니다.     배치Job등록  New Item  Freestyle project을 선택해서 Job을 등록합니다.     java -jar ${JAR_NAME} ${DB_HOST} ${DB_PORT} ${DB_NAME} ${DB_USER} ${DB_PASSWORD} \\ --spring.batch.job.names=${JOB_NAME} version=${BUILD_NUMBER} requestDate=${BUILD_TIMESTAMP} --spring.batch.job.enabled=true --spring.profiles.active=dev 배치Job실행  Job을 실행하고 실행 결과를 확인합니다.  2021-03-31 13:09:56.358 INFO 3564 --- [ main] o.s.b.w.embedded.tomcat.TomcatWebServer : Tomcat started on port(s): 8080 (http) with context path '' 2021-03-31 13:09:56.379 INFO 3564 --- [ main] c.e.sample.batch.BatchApplicationKt : Started BatchApplicationKt in 12.493 seconds (JVM running for 13.807) 2021-03-31 13:09:56.380 INFO 3564 --- [ main] o.s.b.a.b.JobLauncherApplicationRunner : Running default command line with: [version=17, requestDate=2021-03-31] 2021-03-31 13:09:56.516 INFO 3564 --- [ main] o.s.b.c.l.support.SimpleJobLauncher : Job: [SimpleJob: [name=jpaJob]] launched with the following parameters: [{requestDate=2021-03-31, version=17}] 2021-03-31 13:09:56.600 INFO 3564 --- [ main] o.s.batch.core.job.SimpleStepHandler : Executing step: [jpaPagingItemStep] 2021-03-31 13:09:57.071 INFO 3564 --- [ main] o.s.batch.core.step.AbstractStep : Step: [jpaPagingItemStep] executed in 471ms 2021-03-31 13:09:57.092 INFO 3564 --- [ main] o.s.b.c.l.support.SimpleJobLauncher : Job: [SimpleJob: [name=jpaJob]] completed with the following parameters: [{requestDate=2021-03-31, version=17}] and the following status: [COMPLETED] in 521ms 2021-03-31 13:09:57.127 INFO 3564 --- [ main] o.s.s.concurrent.ThreadPoolTaskExecutor : Shutting down ExecutorService 'applicationTaskExecutor' 2021-03-31 13:09:57.129 INFO 3564 --- [ main] j.LocalContainerEntityManagerFactoryBean : Closing JPA EntityManagerFactory for persistence unit 'default' 2021-03-31 13:09:57.140 INFO 3564 --- [ main] com.zaxxer.hikari.HikariDataSource : HikariPool-1 - Shutdown initiated... 2021-03-31 13:09:57.155 INFO 3564 --- [ main] com.zaxxer.hikari.HikariDataSource : HikariPool-1 - Shutdown completed. Finished: SUCCESS BatchApplication.kt  Job실행 종료시 application도 종료시키기 위한 설정  @EnableBatchProcessing @SpringBootApplication class BatchApplication fun main(args: Array) { val context = runApplication(*args) val exitCode = SpringApplication.exit(context) System.exit(exitCode) } ","wordCount":"300","inLanguage":"ko","datePublished":"2021-03-31T00:00:00Z","dateModified":"2021-03-31T00:00:00Z","author":{"@type":"Person","name":"bokyung"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://bokyung.dev/2021/03/31/jenkins-batch-job/"},"publisher":{"@type":"Organization","name":"Bokyung's Note","logo":{"@type":"ImageObject","url":"https://bokyung.dev/favicon.ico"}}}</script><script data-ad-client=ca-pub-8342838924011258 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body id=top><noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-KTQ8KCW" height=0 width=0 style=display:none;visibility:hidden></iframe></noscript><script>window.matchMedia('(prefers-color-scheme: dark)').matches&&document.body.classList.add('dark')</script><noscript><style type=text/css>.theme-toggle,.top-link{display:none}</style></noscript><header class=header><nav class=nav><div class=logo><a href=https://bokyung.dev/ accesskey=h title="Bokyung's Note (Alt + H)"><img src=/images/main_icon.jpg alt=logo aria-label=logo width=30px>Bokyung's Note</a>
<span class=logo-switches><ul class=lang-switch><li>|</li><li><a href=https://bokyung.dev/ja/ title=ja aria-label=ja>Ja</a></li></ul></span></div><ul id=menu onscroll=menu_on_scroll()><li><a href=https://bokyung.dev/archives/ title=Archive><span>Archive</span></a></li><li><a href=https://bokyung.dev/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li><li><a href=https://bokyung.dev/tags/ title=Tags><span>Tags</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class=post-title>Jenkins에서 Spring Batch Job을 실행하기</h1><div class=post-meta>2021-03-31&nbsp;·&nbsp;bokyung
&nbsp;|&nbsp;<ul class=i18n_list>Translations:<li><a href=https://bokyung.dev/ja/2021/03/31/jenkins-batch-job/>Ja</a></li></ul></div></header><div class=toc><details open><summary accesskey=c title="(Alt + C)"><div class=details>목차</div></summary><div class=inner><ul><li><a href=#jenkins-%ed%99%98%ea%b2%bd aria-label="Jenkins 환경">Jenkins 환경</a></li><li><a href=#%ed%99%98%ea%b2%bd%eb%b3%80%ec%88%98%ec%99%80-%ed%94%8c%eb%9f%ac%ea%b7%b8%ec%9d%b8-%ec%84%a4%ec%a0%95 aria-label="환경변수와 플러그인 설정">환경변수와 플러그인 설정</a></li><li><a href=#%eb%b0%b0%ec%b9%98job%eb%93%b1%eb%a1%9d aria-label=배치Job등록>배치Job등록</a></li><li><a href=#%eb%b0%b0%ec%b9%98job%ec%8b%a4%ed%96%89 aria-label=배치Job실행>배치Job실행</a></li><li><a href=#batchapplicationkt aria-label=BatchApplication.kt>BatchApplication.kt</a></li></ul></div></details></div><div class=post-content><p>Jenkins에서 스프링 배치 Job을 실행해 보았습니다.</p><h2 id=jenkins-환경>Jenkins 환경<a hidden class=anchor aria-hidden=true href=#jenkins-환경>#</a></h2><ul><li>Amazon Linux2<ul><li>AMI ID : ami-0f27d081df46f326c</li><li>AMI 이름 : amzn2-ami-hvm-2.0.20210303.0-x86_64-gp2</li></ul></li><li>Jenkins<ul><li>version : Jenkins 2.284</li></ul></li></ul><h2 id=환경변수와-플러그인-설정>환경변수와 플러그인 설정<a hidden class=anchor aria-hidden=true href=#환경변수와-플러그인-설정>#</a></h2><ul><li><p>여러 Job을 등록하는 경우 각각의 Job에서 같은 파라미터를 넘겨주게 되는데 환경변수에 등록해두면 관리하기가 편해집니다.</p></li><li><p>Job파라미터로 실행날짜를 넘겨주기 위해서 <code>timestamper</code>플러그인을 사용하였습니다.<figure><a href=/images/2021/0331/plugin-timestamper.png><img src=/images/2021/0331/plugin-timestamper.png alt=plugin-timestamper></a></figure></p></li><li><p><code>Manage Jenkins > System Configuration > Configure System > Global properties > Environment variables</code>에서 Job에서 공통으로 사용하는 환경변수를 설정합니다.<figure><a href=/images/2021/0331/global-env-setting.png><img src=/images/2021/0331/global-env-setting.png alt=global-env-setting></a></figure></p></li></ul><h2 id=배치job등록>배치Job등록<a hidden class=anchor aria-hidden=true href=#배치job등록>#</a></h2><ul><li><code>New Item > Freestyle project</code>을 선택해서 Job을 등록합니다.<figure><a href=/images/2021/0331/job-build.png><img src=/images/2021/0331/job-build.png alt=job-build></a></figure></li></ul><pre><code>java -jar ${JAR_NAME} ${DB_HOST} ${DB_PORT} ${DB_NAME} ${DB_USER} ${DB_PASSWORD} \
--spring.batch.job.names=${JOB_NAME} version=${BUILD_NUMBER} requestDate=${BUILD_TIMESTAMP} --spring.batch.job.enabled=true --spring.profiles.active=dev
</code></pre><h2 id=배치job실행>배치Job실행<a hidden class=anchor aria-hidden=true href=#배치job실행>#</a></h2><ul><li>Job을 실행하고 실행 결과를 확인합니다.</li></ul><pre><code>2021-03-31 13:09:56.358  INFO 3564 --- [           main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port(s): 8080 (http) with context path ''
2021-03-31 13:09:56.379  INFO 3564 --- [           main] c.e.sample.batch.BatchApplicationKt      : Started BatchApplicationKt in 12.493 seconds (JVM running for 13.807)
2021-03-31 13:09:56.380  INFO 3564 --- [           main] o.s.b.a.b.JobLauncherApplicationRunner   : Running default command line with: [version=17, requestDate=2021-03-31]
2021-03-31 13:09:56.516  INFO 3564 --- [           main] o.s.b.c.l.support.SimpleJobLauncher      : Job: [SimpleJob: [name=jpaJob]] launched with the following parameters: [{requestDate=2021-03-31, version=17}]
2021-03-31 13:09:56.600  INFO 3564 --- [           main] o.s.batch.core.job.SimpleStepHandler     : Executing step: [jpaPagingItemStep]
2021-03-31 13:09:57.071  INFO 3564 --- [           main] o.s.batch.core.step.AbstractStep         : Step: [jpaPagingItemStep] executed in 471ms
2021-03-31 13:09:57.092  INFO 3564 --- [           main] o.s.b.c.l.support.SimpleJobLauncher      : Job: [SimpleJob: [name=jpaJob]] completed with the following parameters: [{requestDate=2021-03-31, version=17}] and the following status: [COMPLETED] in 521ms
2021-03-31 13:09:57.127  INFO 3564 --- [           main] o.s.s.concurrent.ThreadPoolTaskExecutor  : Shutting down ExecutorService 'applicationTaskExecutor'
2021-03-31 13:09:57.129  INFO 3564 --- [           main] j.LocalContainerEntityManagerFactoryBean : Closing JPA EntityManagerFactory for persistence unit 'default'
2021-03-31 13:09:57.140  INFO 3564 --- [           main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown initiated...
2021-03-31 13:09:57.155  INFO 3564 --- [           main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown completed.
Finished: SUCCESS
</code></pre><h2 id=batchapplicationkt>BatchApplication.kt<a hidden class=anchor aria-hidden=true href=#batchapplicationkt>#</a></h2><ul><li>Job실행 종료시 application도 종료시키기 위한 설정</li></ul><pre><code>@EnableBatchProcessing
@SpringBootApplication
class BatchApplication

fun main(args: Array&lt;String&gt;) {
  val context = runApplication&lt;BatchApplication&gt;(*args)
  val exitCode = SpringApplication.exit(context)
  System.exit(exitCode)
}
</code></pre></div><footer class=post-footer><ul class=post-tags><li><a href=https://bokyung.dev/tags/aws/>AWS</a></li><li><a href=https://bokyung.dev/tags/jenkins/>Jenkins</a></li><li><a href=https://bokyung.dev/tags/spring/>Spring</a></li></ul><nav class=paginav><a class=next href=https://bokyung.dev/2021/03/30/jenkins-gradle-build/><span class=title>다음 페이지 »</span><br><span>Jenkins에서 Spring Batch 프로젝트를 Gradle 빌드하기</span></a></nav></footer><script src=https://utteranc.es/client.js repo=bokyung-kang/blog-comments issue-term=title theme=github-light crossorigin=anonymous async></script></article></main><footer class=footer><span>&copy; 2021 <a href=https://bokyung.dev/>Bokyung's Note</a></span>
<span>&#183;</span>
<span>Powered by <a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a></span>
<span>&#183;</span>
<span>Theme <a href=https://git.io/hugopapermod rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)"><button class=top-link id=top-link type=button accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></button></a>
<script defer src=/assets/js/highlight.min.7680afc38aa6b15ddf158a4f3780b7b1f7dde7e91d26f073e6229bb7a0793c92.js integrity="sha256-doCvw4qmsV3fFYpPN4C3sffd5+kdJvBz5iKbt6B5PJI=" onload=hljs.initHighlightingOnLoad()></script><script>window.onload=function(){localStorage.getItem("menu-scroll-position")&&(document.getElementById('menu').scrollLeft=localStorage.getItem("menu-scroll-position"))},document.querySelectorAll('a[href^="#"]').forEach(a=>{a.addEventListener("click",function(b){b.preventDefault();var a=this.getAttribute("href").substr(1);window.matchMedia('(prefers-reduced-motion: reduce)').matches?document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView({behavior:"smooth"}),a==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${a}`)})});var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")};function menu_on_scroll(){localStorage.setItem("menu-scroll-position",document.getElementById('menu').scrollLeft)}</script></body></html>