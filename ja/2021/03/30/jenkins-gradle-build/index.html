<!doctype html><html lang=ja dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Jenkins環境でSpring BatchプロジェクトをGradleビルドする | Bokyung's Note</title><meta name=keywords content="AWS,Jenkins,Spring,gradle"><meta name=description content="Spring BatchのJob Runnerを調査していましたが、その中でJenkinsでbatchプロジェクトをgradleビルドをしてみました。
Jenkinsの環境  Amazon Linux2  AMI ID : ami-0f27d081df46f326c AMI名 : amzn2-ami-hvm-2.0.20210303.0-x86_64-gp2   Jenkins  version : Jenkins 2.284    認証情報登録 Github ID/PASSWORD認証方法   JenkinsでRepository関連作業ができるようにGithub上でPersonal access tokensを発行します。 ( Settings > Developer settings > Personal access tokens )     Manage Jenkins > Manage Credentials > domainにあるglobalをクリックします。     KindはUsername with passwordを選び、パスワード欄にはPersonal access tokens値を入力し認証情報を追加します。     Github SSH 認証方法   SSH鍵を作成します。       Githubプロジェクト設定のDeploy keysに公開鍵を追加します。     KindはSSH Username with private keyを選び、Private Key > Enter directlyに秘密鍵を追加します。     Gradle, JDK設定  プロジェクトで利用するGradleとJDKを Manage Jenkins > System Configuration > Global Tool Configurationにて設定します。一つのバージョンのみ設定した場合は、各JOBでデフォルトとして設定されます。複数のバージョンが登録されている場合は、JOB設定時バージョンを選べられます。     Job登録   New Item > Freestyle projectを選び、JOBを登録します。github access tokens認証の場合は、Repository URLに git@github."><meta name=author content="bokyung"><link rel=canonical href=https://bokyung.dev/ja/2021/03/30/jenkins-gradle-build/><link href=/assets/css/stylesheet.min.51be3134aeb3ee2a7ba26b0517cda3b0602df6d6d88a93c6ffd2baff8d456708.css integrity="sha256-Ub4xNK6z7ip7omsFF82jsGAt9tbYipPG/9K6/41FZwg=" rel="preload stylesheet" as=style><link rel=icon href=https://bokyung.dev/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://bokyung.dev/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://bokyung.dev/favicon-32x32.png><link rel=apple-touch-icon href=https://bokyung.dev/apple-touch-icon.png><link rel=mask-icon href=https://bokyung.dev/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><meta name=generator content="Hugo 0.83.1"><link rel=alternate hreflang=ko href=https://bokyung.dev/2021/03/30/jenkins-gradle-build/><link rel=alternate hreflang=ja href=https://bokyung.dev/ja/2021/03/30/jenkins-gradle-build/><script async src="https://www.googletagmanager.com/gtag/js?id=G-R7DJYPBNN5"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag('js',new Date),gtag('config','G-R7DJYPBNN5')</script><script>(function(b,d,e,a,g){b[a]=b[a]||[],b[a].push({'gtm.start':(new Date).getTime(),event:'gtm.js'});var f=d.getElementsByTagName(e)[0],c=d.createElement(e),h=a!='dataLayer'?'&l='+a:'';c.async=!0,c.src='https://www.googletagmanager.com/gtm.js?id='+g+h,f.parentNode.insertBefore(c,f)})(window,document,'script','dataLayer','GTM-KTQ8KCW')</script></script><meta property="og:title" content="Jenkins環境でSpring BatchプロジェクトをGradleビルドする"><meta property="og:description" content="Spring BatchのJob Runnerを調査していましたが、その中でJenkinsでbatchプロジェクトをgradleビルドをしてみました。
Jenkinsの環境  Amazon Linux2  AMI ID : ami-0f27d081df46f326c AMI名 : amzn2-ami-hvm-2.0.20210303.0-x86_64-gp2   Jenkins  version : Jenkins 2.284    認証情報登録 Github ID/PASSWORD認証方法   JenkinsでRepository関連作業ができるようにGithub上でPersonal access tokensを発行します。 ( Settings > Developer settings > Personal access tokens )     Manage Jenkins > Manage Credentials > domainにあるglobalをクリックします。     KindはUsername with passwordを選び、パスワード欄にはPersonal access tokens値を入力し認証情報を追加します。     Github SSH 認証方法   SSH鍵を作成します。       Githubプロジェクト設定のDeploy keysに公開鍵を追加します。     KindはSSH Username with private keyを選び、Private Key > Enter directlyに秘密鍵を追加します。     Gradle, JDK設定  プロジェクトで利用するGradleとJDKを Manage Jenkins > System Configuration > Global Tool Configurationにて設定します。一つのバージョンのみ設定した場合は、各JOBでデフォルトとして設定されます。複数のバージョンが登録されている場合は、JOB設定時バージョンを選べられます。     Job登録   New Item > Freestyle projectを選び、JOBを登録します。github access tokens認証の場合は、Repository URLに git@github."><meta property="og:type" content="article"><meta property="og:url" content="https://bokyung.dev/ja/2021/03/30/jenkins-gradle-build/"><meta property="article:published_time" content="2021-03-30T00:00:00+00:00"><meta property="article:modified_time" content="2021-03-30T00:00:00+00:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="Jenkins環境でSpring BatchプロジェクトをGradleビルドする"><meta name=twitter:description content="Spring BatchのJob Runnerを調査していましたが、その中でJenkinsでbatchプロジェクトをgradleビルドをしてみました。
Jenkinsの環境  Amazon Linux2  AMI ID : ami-0f27d081df46f326c AMI名 : amzn2-ami-hvm-2.0.20210303.0-x86_64-gp2   Jenkins  version : Jenkins 2.284    認証情報登録 Github ID/PASSWORD認証方法   JenkinsでRepository関連作業ができるようにGithub上でPersonal access tokensを発行します。 ( Settings > Developer settings > Personal access tokens )     Manage Jenkins > Manage Credentials > domainにあるglobalをクリックします。     KindはUsername with passwordを選び、パスワード欄にはPersonal access tokens値を入力し認証情報を追加します。     Github SSH 認証方法   SSH鍵を作成します。       Githubプロジェクト設定のDeploy keysに公開鍵を追加します。     KindはSSH Username with private keyを選び、Private Key > Enter directlyに秘密鍵を追加します。     Gradle, JDK設定  プロジェクトで利用するGradleとJDKを Manage Jenkins > System Configuration > Global Tool Configurationにて設定します。一つのバージョンのみ設定した場合は、各JOBでデフォルトとして設定されます。複数のバージョンが登録されている場合は、JOB設定時バージョンを選べられます。     Job登録   New Item > Freestyle projectを選び、JOBを登録します。github access tokens認証の場合は、Repository URLに git@github."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Jenkins環境でSpring BatchプロジェクトをGradleビルドする","name":"Jenkins環境でSpring BatchプロジェクトをGradleビルドする","description":"Spring BatchのJob Runnerを調査していましたが、その中でJenkinsでbatchプロジェクトをgradleビルドをしてみました。\nJenkinsの環境  Amazon Linux2  AMI ID : ami-0f27d081df46f326c AMI名 : amzn2-ami-hvm-2.0.20210303.0-x86_64-gp2 …","keywords":["AWS","Jenkins","Spring","gradle"],"articleBody":"Spring BatchのJob Runnerを調査していましたが、その中でJenkinsでbatchプロジェクトをgradleビルドをしてみました。\nJenkinsの環境  Amazon Linux2  AMI ID : ami-0f27d081df46f326c AMI名 : amzn2-ami-hvm-2.0.20210303.0-x86_64-gp2   Jenkins  version : Jenkins 2.284    認証情報登録 Github ID/PASSWORD認証方法   JenkinsでRepository関連作業ができるようにGithub上でPersonal access tokensを発行します。 ( Settings  Developer settings  Personal access tokens )     Manage Jenkins  Manage Credentials  domainにあるglobalをクリックします。     KindはUsername with passwordを選び、パスワード欄にはPersonal access tokens値を入力し認証情報を追加します。     Github SSH 認証方法   SSH鍵を作成します。       Githubプロジェクト設定のDeploy keysに公開鍵を追加します。     KindはSSH Username with private keyを選び、Private Key  Enter directlyに秘密鍵を追加します。     Gradle, JDK設定  プロジェクトで利用するGradleとJDKを Manage Jenkins  System Configuration  Global Tool Configurationにて設定します。一つのバージョンのみ設定した場合は、各JOBでデフォルトとして設定されます。複数のバージョンが登録されている場合は、JOB設定時バージョンを選べられます。     Job登録   New Item  Freestyle projectを選び、JOBを登録します。github access tokens認証の場合は、Repository URLに git@github.com:bokyung-kang/batch-testを入力しCredentialsはgithub認証を登録したUsernameを選択します。     ssh認証の場合はRepository URLに git@github.com:bokyung-kang/batch-testを入力しCredentialsはssh認証を登録したUsernameを選択します。     build script\nchmod +x gradlew # testを実行しないようにassembleを実行しました。 ./gradlew assemble # deploy-testへjarをコピー。 mkdir -p $JENKINS_HOME/workspace/deploy-test cp $WORKSPACE/build/libs/*.jar $JENKINS_HOME/workspace/deploy-test/.   Gradle Build  ビルドを実行し、Console Outputを見てみます。  [batch-test] $ /bin/sh -xe /tmp/jenkins568576160326820555.sh + chmod +x gradlew + ./gradlew assemble Starting a Gradle Daemon (subsequent builds will be faster)  Task :compileKotlin  Task :compileJava NO-SOURCE  Task :processResources  Task :classes  Task :bootJarMainClassName  Task :bootJar  Task :inspectClassesForKotlinIC  Task :jar SKIPPED  Task :assemble BUILD SUCCESSFUL in 33s 5 actionable tasks: 5 executed + mkdir -p /var/lib/jenkins/workspace/deploy-test + cp /var/lib/jenkins/workspace/batch-test/build/libs/batch-0.0.1-SNAPSHOT.jar /var/lib/jenkins/workspace/deploy-test/. Finished: SUCCESS  $JENKINS_HOME/workspace/deploy-test/にjarファイルがコピーされていることが確認できます。     ","wordCount":"177","inLanguage":"ja","datePublished":"2021-03-30T00:00:00Z","dateModified":"2021-03-30T00:00:00Z","author":{"@type":"Person","name":"bokyung"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://bokyung.dev/ja/2021/03/30/jenkins-gradle-build/"},"publisher":{"@type":"Organization","name":"Bokyung's Note","logo":{"@type":"ImageObject","url":"https://bokyung.dev/favicon.ico"}}}</script><script data-ad-client=ca-pub-8342838924011258 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body id=top><noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-KTQ8KCW" height=0 width=0 style=display:none;visibility:hidden></iframe></noscript><script>window.matchMedia('(prefers-color-scheme: dark)').matches&&document.body.classList.add('dark')</script><noscript><style type=text/css>.theme-toggle,.top-link{display:none}</style></noscript><header class=header><nav class=nav><div class=logo><a href=https://bokyung.dev/ja/ accesskey=h title="Bokyung's Note (Alt + H)"><img src=/images/main_icon.jpg alt=logo aria-label=logo width=30px>Bokyung's Note</a>
<span class=logo-switches><ul class=lang-switch><li>|</li><li><a href=https://bokyung.dev/ title=ko aria-label=ko>Ko</a></li></ul></span></div><ul id=menu onscroll=menu_on_scroll()><li><a href=https://bokyung.dev/ja/archives/ title=Archive><span>Archive</span></a></li><li><a href=https://bokyung.dev/ja/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li><li><a href=https://bokyung.dev/ja/tags/ title=Tags><span>Tags</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class=post-title>Jenkins環境でSpring BatchプロジェクトをGradleビルドする</h1><div class=post-meta>2021-03-30&nbsp;·&nbsp;bokyung
&nbsp;|&nbsp;<ul class=i18n_list>Translations:<li><a href=https://bokyung.dev/2021/03/30/jenkins-gradle-build/>Ko</a></li></ul></div></header><div class=toc><details open><summary accesskey=c title="(Alt + C)"><div class=details>目次</div></summary><div class=inner><ul><li><a href=#jenkins%e3%81%ae%e7%92%b0%e5%a2%83 aria-label=Jenkinsの環境>Jenkinsの環境</a></li><li><a href=#%e8%aa%8d%e8%a8%bc%e6%83%85%e5%a0%b1%e7%99%bb%e9%8c%b2 aria-label=認証情報登録>認証情報登録</a><ul><li><a href=#github-idpassword%e8%aa%8d%e8%a8%bc%e6%96%b9%e6%b3%95 aria-label="Github ID/PASSWORD認証方法">Github ID/PASSWORD認証方法</a></li><li><a href=#github-ssh-%e8%aa%8d%e8%a8%bc%e6%96%b9%e6%b3%95 aria-label="Github SSH 認証方法">Github SSH 認証方法</a></li><li><a href=#gradle-jdk%e8%a8%ad%e5%ae%9a aria-label="Gradle, JDK設定">Gradle, JDK設定</a></li><li><a href=#job%e7%99%bb%e9%8c%b2 aria-label=Job登録>Job登録</a></li><li><a href=#gradle-build aria-label="Gradle Build">Gradle Build</a></li></ul></li></ul></div></details></div><div class=post-content><p>Spring BatchのJob Runnerを調査していましたが、その中でJenkinsでbatchプロジェクトをgradleビルドをしてみました。</p><h2 id=jenkinsの環境>Jenkinsの環境<a hidden class=anchor aria-hidden=true href=#jenkinsの環境>#</a></h2><ul><li>Amazon Linux2<ul><li>AMI ID : ami-0f27d081df46f326c</li><li>AMI名 : amzn2-ami-hvm-2.0.20210303.0-x86_64-gp2</li></ul></li><li>Jenkins<ul><li>version : Jenkins 2.284</li></ul></li></ul><h2 id=認証情報登録>認証情報登録<a hidden class=anchor aria-hidden=true href=#認証情報登録>#</a></h2><h3 id=github-idpassword認証方法>Github ID/PASSWORD認証方法<a hidden class=anchor aria-hidden=true href=#github-idpassword認証方法>#</a></h3><ul><li><p>JenkinsでRepository関連作業ができるようにGithub上で<code>Personal access tokens</code>を発行します。 ( Settings > Developer settings > Personal access tokens )<figure><a href=/images/2021/0330/gihhub-personal-access-tokens.png><img src=/images/2021/0330/gihhub-personal-access-tokens.png alt=gihhub-personal-access-tokens></a></figure></p></li><li><p>Manage Jenkins > Manage Credentials > domainにあるglobalをクリックします。<figure><a href=/images/2021/0330/global-credential.png><img src=/images/2021/0330/global-credential.png alt=global-credential></a></figure></p></li><li><p>Kindは<code>Username with password</code>を選び、パスワード欄には<code>Personal access tokens</code>値を入力し認証情報を追加します。<figure><a href=/images/2021/0330/ssh-credential.png><img src=/images/2021/0330/ssh-credential.png alt=ssh-credential></a></figure></p></li></ul><h3 id=github-ssh-認証方法>Github SSH 認証方法<a hidden class=anchor aria-hidden=true href=#github-ssh-認証方法>#</a></h3><ul><li><p>SSH鍵を作成します。<figure><a href=/images/2021/0330/generate-ssh-key.png><img src=/images/2021/0330/generate-ssh-key.png alt=generate-ssh-key></a></figure><figure><a href=/images/2021/0330/jenkins-ssh-key.png><img src=/images/2021/0330/jenkins-ssh-key.png alt=jenkins-ssh-key></a></figure></p></li><li><p>Githubプロジェクト設定の<code>Deploy keys</code>に公開鍵を追加します。<figure><a href=/images/2021/0330/deploy-keys.png><img src=/images/2021/0330/deploy-keys.png alt=deploy-keys></a></figure></p></li><li><p>Kindは<code>SSH Username with private key</code>を選び、<code>Private Key > Enter directly</code>に秘密鍵を追加します。<figure><a href=/images/2021/0330/ssh-credential.png><img src=/images/2021/0330/ssh-credential.png alt=ssh-credential></a></figure></p></li></ul><h3 id=gradle-jdk設定>Gradle, JDK設定<a hidden class=anchor aria-hidden=true href=#gradle-jdk設定>#</a></h3><ul><li>プロジェクトで利用するGradleとJDKを <code>Manage Jenkins > System Configuration > Global Tool Configuration</code>にて設定します。一つのバージョンのみ設定した場合は、各JOBでデフォルトとして設定されます。複数のバージョンが登録されている場合は、JOB設定時バージョンを選べられます。<figure><a href=/images/2021/0330/jenkins-global-tool-configuration.png><img src=/images/2021/0330/jenkins-global-tool-configuration.png alt=jenkins-global-tool-configuration></a></figure></li></ul><h3 id=job登録>Job登録<a hidden class=anchor aria-hidden=true href=#job登録>#</a></h3><ul><li><p><code>New Item > Freestyle project</code>を選び、JOBを登録します。github access tokens認証の場合は、Repository URLに <code>git@github.com:bokyung-kang/batch-test</code>を入力しCredentialsはgithub認証を登録したUsernameを選択します。<figure><a href=/images/2021/0330/build-job-github.png><img src=/images/2021/0330/build-job-github.png alt=build-job-github></a></figure></p></li><li><p>ssh認証の場合はRepository URLに <code>git@github.com:bokyung-kang/batch-test</code>を入力しCredentialsはssh認証を登録したUsernameを選択します。<figure><a href=/images/2021/0330/build-job-ssh.png><img src=/images/2021/0330/build-job-ssh.png alt=build-job-ssh></a></figure></p></li><li><p>build script</p><pre><code>chmod +x gradlew

# testを実行しないようにassembleを実行しました。
./gradlew assemble

# deploy-testへjarをコピー。
mkdir -p $JENKINS_HOME/workspace/deploy-test
cp $WORKSPACE/build/libs/*.jar $JENKINS_HOME/workspace/deploy-test/.
</code></pre></li></ul><h3 id=gradle-build>Gradle Build<a hidden class=anchor aria-hidden=true href=#gradle-build>#</a></h3><ul><li>ビルドを実行し、Console Outputを見てみます。</li></ul><pre><code>[batch-test] $ /bin/sh -xe /tmp/jenkins568576160326820555.sh
+ chmod +x gradlew
+ ./gradlew assemble
Starting a Gradle Daemon (subsequent builds will be faster)
&gt; Task :compileKotlin
&gt; Task :compileJava NO-SOURCE
&gt; Task :processResources
&gt; Task :classes
&gt; Task :bootJarMainClassName
&gt; Task :bootJar
&gt; Task :inspectClassesForKotlinIC
&gt; Task :jar SKIPPED
&gt; Task :assemble

BUILD SUCCESSFUL in 33s
5 actionable tasks: 5 executed
+ mkdir -p /var/lib/jenkins/workspace/deploy-test
+ cp /var/lib/jenkins/workspace/batch-test/build/libs/batch-0.0.1-SNAPSHOT.jar /var/lib/jenkins/workspace/deploy-test/.
Finished: SUCCESS
</code></pre><ul><li><code>$JENKINS_HOME/workspace/deploy-test/</code>にjarファイルがコピーされていることが確認できます。<figure><a href=/images/2021/0330/build-jar.png><img src=/images/2021/0330/build-jar.png alt=build-jar></a></figure></li></ul></div><footer class=post-footer><ul class=post-tags><li><a href=https://bokyung.dev/ja/tags/aws/>AWS</a></li><li><a href=https://bokyung.dev/ja/tags/jenkins/>Jenkins</a></li><li><a href=https://bokyung.dev/ja/tags/spring/>Spring</a></li><li><a href=https://bokyung.dev/ja/tags/gradle/>gradle</a></li></ul><nav class=paginav><a class=prev href=https://bokyung.dev/ja/2021/03/31/jenkins-batch-job/><span class=title>« 前のページ</span><br><span>Jenkins環境でSpring Batch Jobを実行する</span></a>
<a class=next href=https://bokyung.dev/ja/2021/03/17/jenkins-install/><span class=title>次のページ »</span><br><span>Amazon Linux2にJenkinsをインストールする</span></a></nav></footer><script src=https://utteranc.es/client.js repo=bokyung-kang/blog-comments issue-term=title theme=github-light crossorigin=anonymous async></script></article></main><footer class=footer><span>&copy; 2021 <a href=https://bokyung.dev/ja/>Bokyung's Note</a></span>
<span>&#183;</span>
<span>Powered by <a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a></span>
<span>&#183;</span>
<span>Theme <a href=https://git.io/hugopapermod rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)"><button class=top-link id=top-link type=button accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></button></a>
<script defer src=/assets/js/highlight.min.7680afc38aa6b15ddf158a4f3780b7b1f7dde7e91d26f073e6229bb7a0793c92.js integrity="sha256-doCvw4qmsV3fFYpPN4C3sffd5+kdJvBz5iKbt6B5PJI=" onload=hljs.initHighlightingOnLoad()></script><script>window.onload=function(){localStorage.getItem("menu-scroll-position")&&(document.getElementById('menu').scrollLeft=localStorage.getItem("menu-scroll-position"))},document.querySelectorAll('a[href^="#"]').forEach(a=>{a.addEventListener("click",function(b){b.preventDefault();var a=this.getAttribute("href").substr(1);window.matchMedia('(prefers-reduced-motion: reduce)').matches?document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView({behavior:"smooth"}),a==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${a}`)})});var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")};function menu_on_scroll(){localStorage.setItem("menu-scroll-position",document.getElementById('menu').scrollLeft)}</script></body></html>